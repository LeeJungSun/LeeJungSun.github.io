<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, shrink-to-fit=no">
<title>Alert sample02</title>
<link rel="stylesheet" href="../css/study-sass.css">
<link rel="stylesheet" href="../css/railscasts.css">
</head>
<body>
<div id="wrap" class="alert_example">
	<h1 class="main__title">2. 스크립트로 DOM을 생성하는 경우</h1>
	<div class="alert_form_wrap">
		<form action="" class="form">
		<fieldset>
			<legend></legend>
			<div class="input_wrap">
				<label for="user_id" class="input_label">아이디</label>
				<div class="input_text">
			   	<input type="text" id="user_id">
				</div>
			</div>
			<div class="input_wrap">
			   <label for="user_password" class="input_label">비밀번호</label>
			   <div class="input_text">
			   	<input type="text" id="user_password">
			   </div>
			   <!-- <p class="alert_text" role="alert" aria-live="polite" aria-atomic="true" style="display:none">비밀번호 안전성 : <span class="level">위험</span></p> -->
			</div>
			<input type="submit" value="전송" class="btn_submit">
		</fieldset>
		</form>		
	</div>
	<pre><code class="html">&lt;form action="" class="form"&gt;
&lt;fieldset&gt;
   &lt;legend&gt;&lt;/legend&gt;
   &lt;div class="input_wrap"&gt;
      &lt;label for="user_id" class="input_label"&gt;아이디&lt;/label&gt;
      &lt;div class="input_text"&gt;
         &lt;input type="text" id="user_id"&gt;
      &lt;/div&gt;
   &lt;/div&gt;
   &lt;div class="input_wrap"&gt;
      &lt;label for="user_password" class="input_label"&gt;비밀번호&lt;/label&gt;
      &lt;div class="input_text"&gt;
         &lt;input type="text" id="user_password"&gt;
      &lt;/div&gt;
   &lt;/div&gt;
   &lt;input type="submit" value="전송" class="btn_submit"&gt;
&lt;/fieldset&gt;
&lt;/form&gt;</code></pre>

</div>
</body>
<script type="text/javascript" src="../js/libs/jquery/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="../js/apps/highlight.pack.js"></script>
<script type="text/javascript">
	hljs.initHighlightingOnLoad();
	$(document).ready(function() {
		$('pre code').each(function(i, block) {
			hljs.highlightBlock(block);
		});
	});

	(function($, win, doc) {
    'use strict';

    	var formtest = {
    		init : function () {
    			this.setElements();
    			this.bindEvents();
    			this.test();
    		},
    		setElements : function () {
 				this.inputForm = $('.form');
				this.userId = $('#user_id');
				this.userPassword = $('#user_password');

				this.re_id = /^[a-z0-9_-]{3,16}$/;
				this.re_pw = /^[a-z0-9_-]{6,18}$/;				
 			},
 			bindEvents : function () {
				this.userId.on('keyup', $.proxy(this.userIdFunc, this));
				this.userPassword.on('keyup', $.proxy(this.userPasswordFunc, this));
 			},
 			userIdFunc : function (e) {
 				var target = $(e.currentTarget),
 					 inputWrap = target.parents('.input_wrap');
 					 // alertText = inputWrap.append('<p class="alert_text"></p>');
 					 
				if (this.userId.val().length == 0) {
					inputWrap.append('<p class="alert_text"></p>');
				} else if (this.userId.val().length < 3) {
					inputWrap.append('<p class="alert_text">너무 짧아요</p>');
				}
				//   else if (this.userId.val().length > 16) {
				// 	alertText.text('너무 길어요.');
				// } else if (this.re_id.test(this.userId.val()) != true ) {
				// 	alertText.text('유효한 문자를 입력해 주세요.');
				// } else {
				// 	alertText.text('적당해요.');
				// }
 			},
 			userPasswordFunc : function (e) {
 				var target = $(e.currentTarget),
 					 inputWrap = target.parents('.input_wrap'),
 					 alertText = inputWrap.find('.alert_text');

 					if (this.userPassword.val().length == 0) {
						alertText.text('');
					} else if (this.userPassword.val().length < 3) {
						alertText.text('너무 짧아요.');
					} else if (this.userPassword.val().length > 16) {
						alertText.text('너무 길어요.');
					} else if (this.re_pw.test(this.userPassword.val()) != true ) {
						alertText.text('유효한 문자를 입력해 주세요.');
					} else {
						alertText.text('적당해요.');
					}
 			},
 			test : function () {
 				var _this = this;
				this.inputForm.submit(function() {
					if (_this.re_id.test(_this.userId.val()) != true) {
						alert('[ID 입력 오류] 유효한 ID를 입력해 주세요.');
						_this.userId.focus();
						return false;
					} else if(_this.re_pw.test(_this.userPassword.val()) != true) {
						alert('[PW 입력 오류] 유효한 PW를 입력해 주세요.');
						_this.userPassword.focus();
						return false;
					}
				});
 			}

    	}


		var inputAlertFunc = {
			init : function () {
				this.setElements();
				this.bindEvent();
			}, 
			setElements : function () {
				this.inputWrap = $('.input_wrap');
				this.inputTextBox = $('.input_text');
				this.alertText = $('.alert_text');
				this.inputText = this.inputTextBox.find('input');
			},
			bindEvent : function () {
				this.inputText.on('keydown', $.proxy(this.alertFunc, this));
			},
			alertFunc : function (e) {
				var input = $(e.currentTarget),
					 inputWrap = input.closest(this.inputWrap);

				if (input.val().length <= 6) {
					inputWrap.find(this.inputTextBox).addClass('error');
					inputWrap.find(this.alertText).show();
				} else if (input.val().length > 6 && input.val().length <= 12) {
					inputWrap.find(this.alertText).find('.level').text('보통');
				} else if (input.val().length > 13 && input.val().length <= 20) {
					inputWrap.find(this.alertText).find('.level').text('안전');
				} else if (input.val().length > 21) {
					inputWrap.find(this.inputTextBox).removeClass('error');
					inputWrap.find(this.alertText).hide();
				}
			}
		};
		$(function () {
			inputAlertFunc.init();
			formtest.init();
		})
    

	})(jQuery, window, document);

</script>
</html>